; Simple test program for Palindrome VM
; Tests RISA (Reversible Instruction Set Architecture)

main:
    ; Create checkpoint
    CHECKPOINT beginning
    
    ; Load some values
    LI R0, 10
    LI R1, 20
    LI R2, 0
    LI R3, 0
    
    ; Perform reversible arithmetic
    RADD R0, R1, R2    ; R2 = R2 + R0 + R1 = 0 + 10 + 20 = 30
    LI R4, 10
    LI R5, 1
    RADD R2, R4, R3    ; R3 = R3 + R2 + R4 = 0 + 30 + 10 = 40
    
    ; Test stack operations  
    PUSH R3
    PUSH R2
    
    POP R4             ; R4 = 30
    POP R5             ; R5 = 300
    
    ; Test comparison
    CMP R6, R4, R2     ; Should be equal
    DEBUG Comparison result (should be 0)
    
    ; Test tape operations
    TAPEWRITE R3, 8    ; Write 300 to tape
    TAPEADVANCE -8     ; Go back
    TAPEREAD R7, 8     ; Read it back
    
    DEBUG All tests complete
    
    ; Uncomment to test reversal:
    ; REWIND beginning
    
    HALT